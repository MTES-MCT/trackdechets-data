version: 2
sources:
  - name: raw_zone_insee
    description: Données issues de l'open data INSEE
    loader: airflow
    tables:
      - name: code_arrondissement
        description: >
          Données géographiques INSEE des arrondissements français.
          Une ligne par code arrondissement.
        columns:
          - name: ARR
            data_type: String
          - name: DEP
            data_type: String
          - name: REG
            data_type: String
          - name: CHEFLIEU
            data_type: String
          - name: TNCC
            data_type: String
          - name: NCC
            data_type: String
          - name: NCCENR
            data_type: String
          - name: LIBELLE
            data_type: String
      - name: code_canton
        description: >
          Données géographiques INSEE des cantons français.
          Une ligne par identifiant canton.
        columns:
          - name: CAN
            data_type: String
          - name: DEP
            data_type: String
          - name: REG
            data_type: String
          - name: COMPCT
            data_type: String
          - name: BURCENTRAL
            data_type: String
          - name: TNCC
            data_type: Int32
          - name: NCC
            data_type: String
          - name: NCCENR
            data_type: String
          - name: LIBELLE
            data_type: String
          - name: TYPECT
            data_type: String
      - name: code_commune
        description: >
          Données géographiques INSEE des communes françaises.
          Une ligne par code commune.
        columns:
          - name: TYPECOM
            data_type: String
          - name: COM
            data_type: String
          - name: REG
            data_type: String
          - name: DEP
            data_type: String
          - name: CTCD
            data_type: String
          - name: ARR
            data_type: String
          - name: TNCC
            data_type: UInt8
          - name: NCC
            data_type: String
          - name: NCCENR
            data_type: String
          - name: LIBELLE
            data_type: String
          - name: CAN
            data_type: String
          - name: COMPARENT
            data_type: String
      - name: code_departement
        description: >
          Données géographiques INSEE des département français.
          Une ligne par code département.
        columns:
          - name: DEP
            data_type: String
          - name: REG
            data_type: String
          - name: CHEFLIEU
            data_type: String
          - name: TNCC
            data_type: UInt8
          - name: NCC
            data_type: String
          - name: NCCENR
            data_type: String
          - name: LIBELLE
            data_type: String
      - name: code_region
        description: >
          Données géographiques INSEE des régions françaises.
          Une ligne par région.
        columns:
          - name: REG
            data_type: String
          - name: CHEFLIEU
            data_type: String
          - name: TNCC
            data_type: UInt8
          - name: NCC
            data_type: String
          - name: NCCENR
            data_type: String
          - name: LIBELLE
            data_type: String
      - name: stock_etablissement
        description: >
          Données des établissements français.
          Une ligne par établissement.
        columns:
          - name: siren
            data_type: string
          - name: nic
            data_type: string
          - name: siret
            description: Code région
            tests:
              - unique
              - not_null
            data_type: string
          - name: statutDiffusionEtablissement
            data_type: string
          - name: dateCreationEtablissement
            data_type: date
          - name: trancheEffectifsEtablissement
            data_type: string
          - name: anneeEffectifsEtablissement
            data_type: int16
          - name: activitePrincipaleRegistreMetiersEtablissement
            data_type: string
          - name: dateDernierTraitementEtablissement
            data_type: datetime
          - name: etablissementSiege
            data_type: bool
          - name: nombrePeriodesEtablissement
            data_type: uint8
          - name: complementAdresseEtablissement
            data_type: string
          - name: numeroVoieEtablissement
            data_type: string
          - name: indiceRepetitionEtablissement
            data_type: string
          - name: dernierNumeroVoieEtablissement
            data_type: string
          - name: indiceRepetitionDernierNumeroVoieEtablissement
            data_type: string
          - name: typeVoieEtablissement
            data_type: string
          - name: libelleVoieEtablissement
            data_type: string
          - name: codePostalEtablissement
            data_type: string
          - name: libelleCommuneEtablissement
            data_type: string
          - name: libelleCommuneEtrangerEtablissement
            data_type: string
          - name: distributionSpecialeEtablissement
            data_type: string
          - name: codeCommuneEtablissement
            data_type: string
          - name: codeCedexEtablissement
            data_type: string
          - name: libelleCedexEtablissement
            data_type: string
          - name: codePaysEtrangerEtablissement
            data_type: string
          - name: libellePaysEtrangerEtablissement
            data_type: string
          - name: identifiantAdresseEtablissement
            data_type: string
          - name: coordonneeLambertAbscisseEtablissement
            data_type: string
          - name: coordonneeLambertOrdonneeEtablissement
            data_type: string
          - name: complementAdresse2Etablissement
            data_type: string
          - name: numeroVoie2Etablissement
            data_type: string
          - name: indiceRepetition2Etablissement
            data_type: string
          - name: typeVoie2Etablissement
            data_type: string
          - name: libelleVoie2Etablissement
            data_type: string
          - name: codePostal2Etablissement
            data_type: string
          - name: libelleCommune2Etablissement
            data_type: string
          - name: libelleCommuneEtranger2Etablissement
            data_type: string
          - name: distributionSpeciale2Etablissement
            data_type: string
          - name: codeCommune2Etablissement
            data_type: string
          - name: codeCedex2Etablissement
            data_type: string
          - name: libelleCedex2Etablissement
            data_type: string
          - name: codePaysEtranger2Etablissement
            data_type: string
          - name: libellePaysEtranger2Etablissement
            data_type: string
          - name: dateDebut
            data_type: date
          - name: etatAdministratifEtablissement
            data_type: string
          - name: enseigne1Etablissement
            data_type: string
          - name: enseigne2Etablissement
            data_type: string
          - name: enseigne3Etablissement
            data_type: string
          - name: denominationUsuelleEtablissement
            data_type: string
          - name: activitePrincipaleEtablissement
            data_type: string
          - name: nomenclatureActivitePrincipaleEtablissement
            data_type: string
          - name: caractereEmployeurEtablissement
            data_type: string
      - name: code_territoires_outre_mer
        description: >-
          Code géographique pour les collectivités et terrtioitres d'Outre-Mer.
        columns:
          - name: COM_COMER
            data_type: String
          - name: TNCC
            data_type: UInt8
          - name: NCC
            data_type: String
          - name: NCCENR
            data_type: String
          - name: LIBELLE
            data_type: String
          - name: NATURE_ZONAGE
            data_type: String
          - name: COMER
            data_type: String
          - name: LIBELLE_COMER
            data_type: String

      - name: annuaire_entreprises_unite_legale
        description: >
          Données des unités légales français.
          Une ligne par unité légale.
        columns:
            - name: siren
              data_type: String
              description: "Numéro unique de l'entreprise (source: base Sirene)"
            - name: siret_siege
              data_type: String
              description: "Numéro unique de l'établissement siège (source: base Sirene)"
            - name: nom_complet
              data_type: String
              description: "Champs construit depuis les champs de dénomination : denomination de l'unité légale | Nom et prénom | Nom inconnu (dénomination usuelle : construite à partir des trois champs de dénomination usuelle de la base SIRENE) (sigle de l'unité légale)"
            - name: etat_administratif
              data_type: String
              description: "État administratif de l'unité légale. 'A' pour Active, 'C' pour Cessée (source : base Sirene)"
            - name: statut_diffusion
              data_type: String
              description: "Statut de diffusion de le l'unité légale (source : base Sirene)"
              meta:
                enum: ["O", "P"]
            - name: nombre_etablissements
              data_type: Int64
              description: "Nombre des établissements de l'unité légale (source : base Sirene)"
            - name: nombre_etablissements_ouverts
              data_type: Int64
              description: "Nombre des établissements ouverts de l'unité légale (source : base Sirene)"
            - name: nature_juridique
              data_type: String
              description: "Nature juridique de l'unité légale (source : base Sirene)"
            - name: colter_code
              data_type: String
              description: "Code affilié à une collectivité territoriale (Commune - code INSEE, EPCI - n° SIREN, Département - Code INSEE + 'D' (sauf cas particulier), Région - Code INSEE)"
            - name: colter_code_insee
              data_type: String
              description: "Code INSEE de la collectivité territoriale"
            - name: colter_elus
              data_type: String
              description: "Élus enregistrés au Répertoire National des Élus(source : Ministère de l'Intérieur et des Outre-Mer)"
            - name: colter_niveau
              data_type: String
              description: "Niveau de collectivité territoriale"
              meta:
                enum: ["commune", "epci", "departement", "region", "particulier"]
            - name: date_mise_a_jour_insee
              data_type: Date
              description: "Date de mise à jour de la donnée dans la base Sirene (source: base Sirene)"
            - name: date_mise_a_jour_rne
              data_type: Date
              description: "Date de mise à jour de la donnée dans le RNE (source : le RNE)"
            - name: egapro_renseignee
              data_type: Boolean
              description: "Indique si au moins un établissement a un indice égalité professionnel H/F renseigné (source : Ministère du Travail du Plein emploi et de l'Insertion)"
            - name: est_association
              data_type: Boolean
              description: "L'unité légale est une association (source : base Sirene)"
            - name: est_entrepreneur_individuel
              data_type: Boolean
              description: "Entreprise individuelle (source : base Sirene)"
            - name: est_entrepreneur_spectacle
              data_type: Boolean
              description: "Entreprise ayant une licence d'entrepreneur du spectacle (source : Ministère de la Culture)"
            - name: statut_entrepreneur_spectacle
              data_type: String
              description: "Statut des établissements ayant fait une demande de licence d'entrepreneur du spectacle (source : Ministère de la Culture)"
            - name: est_ess
              data_type: Boolean
              description: "Entreprises appartenant au champ de l'économie sociale et solidaire (source : base Sirene et ESS France)"
            - name: est_organisme_formation
              data_type: Boolean
              description: "Entreprise ayant au moins un établissement organisme de formation (source : Ministère du Travail)"
            - name: est_qualiopi
              data_type: Boolean
              description: "Entreprise ayant une certification de la marque « Qualiopi » (source : Ministère du Travail)"
            - name: est_service_public
              data_type: Boolean
              description: > 
                Uniquement les structures reconnues comme service public. 
                Attention : Cette donnée se base sur des règles de gestion documentées ici: https://github.com/annuaire-entreprises-data-gouv-fr/search-infra/blob/97b81953f060015b881f44482897a066f2cd34cf/data_enrichment.py#L103. 
                Cette donnée n'est pas exhaustive et peut contenir des faux positifs.
            - name: est_societe_mission
              data_type: Boolean
              description: "Société qui appartient au champ des sociétés à mission (source : base Sirene)"
            - name: liste_elus
              data_type: String
              description: "Liste des élus s'il s'agit de collectivé territoriale (source : Ministère de l'Intérieur et des Outre-Mer)"
            - name: liste_id_organisme_formation
              data_type: String
              description: "Liste des numéros de déclaration d'activité des établissement organismes de formation (source : Ministère du Travail)"
            - name: liste_idcc
              data_type: String
              description: "Liste des conventions collectives de l'unité légale (source : Ministère du travail)"
            - name: est_siae
              data_type: Boolean
              description: "Structure d'insertion par l'activité économique (source : Marché de l'Inclusion)"
            - name: type_siae
              data_type: String
              description: "Type de structure de l'inclusion (source : Marché de l'Inclusion)"
